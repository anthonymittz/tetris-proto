(()=>{var t,e,n,r={82:(t,e,n)=>{function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function i(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var a=n(509),c=n(491),s=n(534),u=n(982),l=new WeakSet,f=new WeakSet,h=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),o(this,f),o(this,l),this.overlay=new c(u.overlay,(function(){return e.pause()})),this.game=new a,this.renderer=new s(this.game),this.isPaused=!0,this.lastRendered=0,this.stepCounter=0,this.interval=1e3,this.restart()}var e,n;return e=t,n=[{key:"run",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.isPaused||i(this,l,p).call(this,e),this.renderer.draw(),requestAnimationFrame((function(e){return t.run(e)}))}},{key:"pause",value:function(){this.isPaused?(this.isPaused=!1,this.overlay.hide()):(this.isPaused=!0,this.overlay.showPauseScreen())}},{key:"restart",value:function(){this.isPaused=!0,this.lastRendered=0,this.stepCounter=0,this.interval=1e3,this.overlay.showNewGameScreen()}},{key:"finish",value:function(){this.isPaused=!0,this.game.finish(),this.overlay.showFinishScreen()}}],n&&r(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function p(t){this.stepCounter+=t-this.lastRendered,this.lastRendered=t,this.stepCounter>this.interval&&i(this,f,y).call(this)}function y(){this.game.actions.drop(),this.stepCounter=0,u.score.innerText=this.game.player.pos.y}t.exports=h},921:t=>{function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var n=function(){function t(e){var n,r,o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r={left:{keys:["KeyA","ArrowLeft"],action:function(){return o.tetris.isPaused||o.actions.move(-1)}},right:{keys:["KeyD","ArrowRight"],action:function(){return o.tetris.isPaused||o.actions.move(1)}},drop:{keys:["KeyS","ArrowDown"],action:function(){return o.tetris.isPaused||o.actions.drop()}},rotateCW:{keys:["KeyE","ArrowUp"],action:function(){return o.tetris.isPaused||o.actions.rotate(-1)}},rotateCCW:{keys:["KeyQ"],action:function(){return o.tetris.isPaused||o.actions.rotate(1)}},skip:{keys:["Space"],action:function(){return o.tetris.isPaused||o.actions.skip()}},pause:{keys:["Escape","Enter"],action:function(t){t.preventDefault(),o.tetris.pause()}},restart:{keys:["KeyR"],action:function(){return o.tetris.restart()}}},(n="bindings")in this?Object.defineProperty(this,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[n]=r,this.tetris=e,this.actions=e.game.actions,this.bindingList=Object.keys(this.bindings)}var n,r;return n=t,(r=[{key:"press",value:function(t){var e=this;this.bindingList.forEach((function(n){return e.bindings[n].keys.includes(t.code)&&e.bindings[n].action(t)}))}}])&&e(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();t.exports=n},869:t=>{function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var n=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.arena=e,this.context=n,this.colors=r}var n,r;return n=t,(r=[{key:"draw",value:function(){var t=this;this.clear(),this.arena.forEach((function(e,n){return e.forEach((function(e,r){0!==e&&(t.context.fillStyle=t.colors[e],t.context.fillRect(r,n,1,1))}))}))}},{key:"clear",value:function(){this.context.fillStyle=this.colors[0],this.context.fillRect(0,0,this.arena[0].length,this.arena.length)}}])&&e(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();t.exports=n},380:t=>{function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var n=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.player=e,this.context=n,this.colors=r}var n,r;return n=t,(r=[{key:"draw",value:function(){var t=this;this.player.tetromino.forEach((function(e,n){return e.forEach((function(e,r){0!==e&&(t.context.fillStyle=t.colors[e],t.context.fillRect(r+t.player.pos.x,n+t.player.pos.y,1,1))}))}))}}])&&e(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();t.exports=n},176:t=>{function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var n=new WeakSet,r=function(){function t(e,r,o,i){var a,c;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(a=this,c=n),c.add(a),this.tetromino=e,this.context=r,this.colors=i,this.width=this.context.canvas.clientWidth,this.height=this.context.canvas.clientHeight,this.scale=o,this.center={x:this.width/this.scale/2|0,y:this.height/this.scale/2|0}}var r,i;return r=t,(i=[{key:"draw",value:function(){var t=this;this.clear();var e=function(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}(this,n,o).call(this,this.tetromino[0].length,this.tetromino.length);this.tetromino.forEach((function(n,r){return n.forEach((function(n,o){0!==n&&(t.context.fillStyle=t.colors[n],t.context.fillRect(o+e.x,r+e.y,1,1))}))}))}},{key:"clear",value:function(){this.context.fillStyle=this.colors[0],this.context.fillRect(0,0,this.width,this.height)}}])&&e(r.prototype,i),Object.defineProperty(r,"prototype",{writable:!1}),t}();function o(t,e){return{x:this.center.x-(e/2|0),y:this.center.y-(t/2|0)}}t.exports=r},534:(t,e,n)=>{function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(380),i=n(869),a=n(176),c=n(982),s=n(434),u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.arenaDrawer=new i(e.arena,c.gameCanvas.context,s),this.playerDrawer=new o(e.player,c.gameCanvas.context,s),this.previewDrawer=new a(e.nextTetromino,c.previewCanvas.context,c.previewCanvas.scale,s)}var e,n;return e=t,(n=[{key:"draw",value:function(){this.arenaDrawer.draw(),this.playerDrawer.draw(),this.previewDrawer.draw()}}])&&r(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.exports=u},495:t=>{function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var n=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.controls=e}var n,r;return n=t,(r=[{key:"register",value:function(){var t=this;window.addEventListener("keydown",(function(e){return t.keyDown(e)})),window.addEventListener("beforeunload",(function(){return t.beforeUnload()}))}},{key:"unregister",value:function(){var t=this;window.removeEventListener("keydown",(function(e){return t.keyDown(e)})),window.addEventListener("beforeunload",(function(){return t.beforeUnload()}))}},{key:"keyDown",value:function(t){this.controls.press(t)}},{key:"beforeUnload",value:function(){}}])&&e(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();t.exports=n},736:t=>{function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var n=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.arena=e,this.player=n,this.progress=r}var n,r;return n=t,(r=[{key:"drop",value:function(){this.player.down(),this.arena.collide(this.player.tetromino,this.player.pos)&&(this.player.up(),this.progress())}},{key:"rotate",value:function(t){t>0?this.player.rotateCW():this.player.rotateCCW(),console.log("[Actions] rotate",t>0?"cw":"ccw")}},{key:"move",value:function(t){t>0?this.player.right():this.player.left(),this.arena.collide(this.player.tetromino,this.player.pos)&&(t>0?this.player.left():this.player.right())}},{key:"skip",value:function(){console.log("[Actions] skip")}}])&&e(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();t.exports=n},509:(t,e,n)=>{function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(736),i=n(889),a=n(997),c=n(131),s=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.score=0,this.arena=new i,this.bag=new c;var n=this.bag.pull();this.nextTetromino=this.bag.next(),this.player=new a(n),this.actions=new o(this.arena,this.player,(function(){return e.progress()}))}var e,n;return e=t,(n=[{key:"addScore",value:function(){this.score+=10}},{key:"progress",value:function(){this.player.reset(this.nextTetromino),this.nextTetromino=this.bag.pull(),this.addScore()}},{key:"resume",value:function(){console.log("[Game] resume")}},{key:"finish",value:function(){console.log("[Game] Finished",this.score),this.summarize()}},{key:"summarize",value:function(){console.log("[Game] summarize")}}])&&r(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.exports=s},300:t=>{function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var r=n((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}));t.exports=r},130:(t,e,n)=>{function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return function(t,e){if(t!==e)throw new TypeError("Private static access of wrong provenance")}(t,e),function(t,e){if(void 0===t)throw new TypeError("attempted to get private static field before its declaration")}(n),function(t,e){return e.get?e.get.call(t):e.value}(t,n)}var a=n(434),c=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i(t,t,s);r(this,t),this.element=e,this.context=this.element.getContext("2d"),this.colors=a,this.width=this.element.width,this.height=this.element.height,this.scale=n.scale,this.context.scale(this.scale,this.scale),this.clear()}var e,n;return e=t,(n=[{key:"clear",value:function(){this.context.fillStyle=this.colors[0],this.context.fillRect(0,0,this.width,this.height)}}])&&o(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),s={writable:!0,value:{scale:20}};t.exports=c},491:t=>{function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function r(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var o,i,a,c=new WeakSet,s=new WeakSet,u=new WeakSet,l=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n(this,u),n(this,s),n(this,c),this.element=e,this.state=t.state.start,this.visible=!0,this.element.addEventListener("click",(function(){return r()}))}var o,i;return o=t,(i=[{key:"hide",value:function(){r(this,s,h).call(this),this.state=t.state.hidden}},{key:"showNewGameScreen",value:function(){r(this,u,p).call(this),this.state=t.state.start,r(this,c,f).call(this,"start")}},{key:"showPreviousGameScreen",value:function(){r(this,u,p).call(this),this.state=t.state.choose,r(this,c,f).call(this,"choose")}},{key:"showPauseScreen",value:function(){r(this,u,p).call(this),this.state=t.state.pause,r(this,c,f).call(this,"pause")}},{key:"showOptionsScreen",value:function(){this.state=t.state.options,r(this,c,f).call(this,"options")}},{key:"showControlScreen",value:function(){this.state=t.state.controls,r(this,c,f).call(this,"controls")}},{key:"showChartScreen",value:function(){this.state=t.state.chart,r(this,c,f).call(this,"chart")}},{key:"showFinishScreen",value:function(){r(this,u,p).call(this),this.state=t.state.pause,r(this,c,f).call(this,"finish")}}])&&e(o.prototype,i),Object.defineProperty(o,"prototype",{writable:!1}),t}();function f(t){this.element.innerText="[Overlay] ".concat(t,".")}function h(){this.element.classList.add("hidden")}function p(){this.element.classList.remove("hidden")}a={hidden:"hidden",start:"start",finish:"finish",choose:"choose",pause:"pause",options:"options",controls:"controls",chart:"chart"},(i="state")in(o=l)?Object.defineProperty(o,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[i]=a,t.exports=l},982:(t,e,n)=>{function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var i=n(434),a=n(130),c=new(o((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.score=document.getElementById("score"),this.stopwatch=document.getElementById("stopwatch"),this.overlay=document.getElementById("overlay"),this.pause=document.getElementById("pause"),this.controls=document.getElementById("controls"),this.gameCanvas=new a(document.getElementById("game"),{colors:i,scale:20}),this.previewCanvas=new a(document.getElementById("preview"),{colors:i,scale:5})})));t.exports=c},889:(t,e,n)=>{function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}function c(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function s(t){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},s(t)}var u=n(885),l=n(103).arena,f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(h,t);var e,n,r,u,f=(r=h,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=s(r);if(u){var n=s(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return c(this,t)});function h(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.width,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.height;return o(this,h),f.call(this,t,e)}return e=h,(n=[{key:"sweep",value:function(){console.log("[arena] sweep")}},{key:"reset",value:function(){console.log("[arena] reset")}}])&&i(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),h}(u);t.exports=f},131:(t,e,n)=>{function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return a(t)}function a(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){var e="function"==typeof Map?new Map:void 0;return c=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return s(t,arguments,f(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),l(r,t)},c(t)}function s(t,e,n){return s=u()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&l(o,n.prototype),o},s.apply(null,arguments)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function l(t,e){return l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},l(t,e)}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function h(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function p(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var y,v,w,b=n(597),d=new WeakSet,m=new WeakSet,g=new WeakSet,k=new WeakSet,O=new WeakSet,E=new WeakSet,x=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(y,t);var e,n,r,c,s=(e=y,n=u(),function(){var t,r=f(e);if(n){var o=f(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return i(this,t)});function y(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),h(a(e=s.call(this)),E),h(a(e),O),h(a(e),k),h(a(e),g),h(a(e),m),h(a(e),d),t?p(a(e),k,T).call(a(e),t):p(a(e),g,S).call(a(e)),e}return r=y,(c=[{key:"shake",value:function(){p(this,E,R).call(this),p(this,d,P).call(this)}},{key:"equals",value:function(t){var e=this;return t.length===this.length&&t.every((function(t,n){return t===e[n]}))}},{key:"pull",value:function(){var t=this.shift();return this.length<3&&p(this,d,P).call(this),new b(t)}},{key:"next",value:function(){return new b(this[0])}}])&&o(r.prototype,c),Object.defineProperty(r,"prototype",{writable:!1}),y}(c(Array));function P(){var t=this;(new x).forEach((function(e){return t.push(e)}))}function j(t){for(var e=[];e.length<t;){var n=Math.floor(Math.random()*t);e.includes(n)||e.push(n)}return e}function S(){var t=this;p(this,m,j).call(this,x.availableShapes.length).forEach((function(e){return t.push(x.availableShapes[e])}))}function T(t){var e=this;p(this,O,C).call(this,t),t.split("").forEach((function(t){return e.push(t)}))}function C(t){t.split("").forEach((function(t){if(!x.availableShapes.includes(t))throw new Error("You must provide a template that contains only the known types of Tetrominoes.")}))}function R(){this.length=0}y=x,v="availableShapes",w=Object.keys(b.shapes),v in y?Object.defineProperty(y,v,{value:w,enumerable:!0,configurable:!0,writable:!0}):y[v]=w,t.exports=x},885:t=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,n){if(n&&("object"===e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return i(t)}function i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a(t){var e="function"==typeof Map?new Map:void 0;return a=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return c(t,arguments,l(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),u(r,t)},a(t)}function c(t,e,n){return c=s()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&u(o,n.prototype),o},c.apply(null,arguments)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function u(t,e){return u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},u(t,e)}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}function f(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function h(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function p(t,e,n){return function(t,e){if(t!==e)throw new TypeError("Private static access of wrong provenance")}(t,e),n}var y=new WeakSet,v=new WeakSet,w=new WeakSet,b=new WeakSet,d=new WeakSet,m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(_,t);var e,a,c,m,E,x=(e=_,a=s(),function(){var t,n=l(e);if(a){var r=l(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return o(this,t)});function _(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,o=arguments.length>2?arguments[2]:void 0;if(n(this,_),f(i(t=x.call(this)),d),f(i(t),b),f(i(t),w),f(i(t),v),f(i(t),y),o){r=o.length;var a=_.fromArray(o);a.forEach((function(e){return t.push(e)}))}else for(p(_,_,S).call(_,e,r);r--;)t.push(new Array(e).fill(0));return t}return c=_,m=[{key:"equals",value:function(t){var e=this;return p(_,_,j).call(_,t),t.length===this.length&&(t.every((function(t,n){t.every((function(t,r){if(!e[n][r]||e[n][r]!==t)return!1}))})),!0)}},{key:"rotate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;console.log("[matrix] rotate!"),p(_,_,C).call(_,t),t>0?h(this,v,k).call(this):h(this,w,O).call(this)}},{key:"width",value:function(){return this[0].length}},{key:"height",value:function(){return this.length}},{key:"fill",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.forEach((function(n,r){return n.forEach((function(n,o){return t[r][o]=e}))}))}},{key:"collide",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0};return p(_,_,j).call(_,t),p(_,_,R).call(_,e),h(this,y,g).call(this,t,e)}}],E=[{key:"fromArray",value:function(t){p(this,_,P).call(this,t),p(this,_,T).call(this,t);var e=t.length,n=new _(t[0].length,e);return t.forEach((function(t,e){t.forEach((function(t,r){n[e][r]=t}))})),n}}],m&&r(c.prototype,m),E&&r(c,E),Object.defineProperty(c,"prototype",{writable:!1}),_}(a(Array));function g(t,e){for(var n=0;n<t.length;n++)for(var r=0;r<t[n].length;r++)if(0!==t[n][r]&&0!==(this[n+e.y]&&this[n+e.y][r+e.x]))return!0;return!1}function k(){var t=this,e=h(this,b,E).call(this);e.forEach((function(n,r){return t[r]=e[r].reverse()})),h(this,d,x).call(this,e.length)}function O(){var t=this,e=h(this,b,E).call(this);e.forEach((function(n,r){return t[r]=e[r]})),h(this,d,x).call(this,e.length),this.reverse()}function E(){var t=this;return this[0].map((function(e,n){return t.map((function(t){return t[n]}))}))}function x(t){if(t<this.length){var e=this.length-t;this.splice(t,e)}}function P(t){if(void 0===t||!1===Array.isArray(t))throw new Error("You must provide an array.")}function j(t){if(void 0===t||!(t instanceof m))throw new Error("You must provide an instance of Matrix.")}function S(t,e){if(t<2||e<2)throw new Error("Cannot be smaller than 2x2.")}function T(t){var e=t[0].length;t.forEach((function(t){if(t.length!==e)throw new Error("All rows must have the same length.")}))}function C(t){if(!t||"number"!=typeof t||0===t)throw new Error("You must provide any positive or negative number except 0.")}function R(t){if("number"!=typeof t.x||"number"!=typeof t.y)throw new Error("You must provide an offset in format: {x: number, y: number}.")}t.exports=m},997:(t,e,n)=>{function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,i,a,c=n(103).arena,s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tetromino=e,this.pos={x:t.posX,y:0},this.rot=0}var e,n;return e=t,n=[{key:"left",value:function(){this.pos.x--}},{key:"right",value:function(){this.pos.x++}},{key:"up",value:function(){this.pos.y--}},{key:"down",value:function(){this.pos.y++}},{key:"rotateCW",value:function(){this.rot++,this.rot>3&&(this.rot=0),this.tetromino.rotate()}},{key:"rotateCCW",value:function(){this.rot--,this.rot<0&&(this.rot=3),this.tetromino.rotate(-1)}},{key:"drop",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return!0};!t();)this.down();this.up()}},{key:"reset",value:function(e){this.tetromino=e,this.pos={x:t.posX,y:0},this.rot=0}}],n&&r(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();o=s,i="posX",a=c.width/2|0,i in o?Object.defineProperty(o,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):o.posX=a,t.exports=s},597:(t,e,n)=>{function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){return i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},i(t,e)}function a(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function s(t,e,n){return function(t,e){if(t!==e)throw new TypeError("Private static access of wrong provenance")}(t,e),n}var u,l,f,h=n(885),p=n(434),y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i(t,e)}(l,t);var e,n,r,u=(n=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=c(n);if(r){var o=c(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return a(this,t)});function l(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"T",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s(l,l,b).call(l);o(this,l),s(l,l,v).call(l,t);var n=s(l,l,w).call(l,l.shapes[t],e);return u.call(this,n[0].length,n.length,n)}return e=l,Object.defineProperty(e,"prototype",{writable:!1}),e}(h);function v(t){var e=Object.keys(y.shapes);if("string"!=typeof t||0===t.length)throw new Error("Unknown type of tetromino: ".concat(t));if(!e.includes(t))throw new Error('Tetromino of the shape "'.concat(t,'" does not exist.'))}function w(t,e){return t.map((function(t){return t.map((function(t){return 0===t?0:e}))}))}function b(){return Math.random()*(p.length-1)+1|0}f={I:[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]],J:[[0,1,0],[0,1,0],[1,1,0]],L:[[0,1,0],[0,1,0],[0,1,1]],O:[[1,1],[1,1]],S:[[0,0,0],[0,1,1],[1,1,0]],T:[[0,0,0],[1,1,1],[0,1,0]],Z:[[0,0,0],[1,1,0],[0,1,1]]},(l="shapes")in(u=y)?Object.defineProperty(u,l,{value:f,enumerable:!0,configurable:!0,writable:!0}):u[l]=f,t.exports=y},434:t=>{"use strict";t.exports=JSON.parse('["#252525","#e65e5e","#db7944","#c5923a","#a9a848","#8ab968","#6ac792","#4dd1bd"]')},103:t=>{"use strict";t.exports=JSON.parse('{"arena":{"width":12,"height":20}}')}},o={};function i(t){var e=o[t];if(void 0!==e)return e.exports;var n=o[t]={exports:{}};return r[t](n,n.exports,i),n.exports}e=i(82),i(300),n=i(921),new(i(495))(new n(t=new e)).register(),t.run()})();
//# sourceMappingURL=tetris.js.map